The purpose of this branch is to make the become variable conditional, based on OS.
Once merged back into main, we will look at refactoring to reduce priv escalation.