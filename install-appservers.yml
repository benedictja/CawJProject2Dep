---
# file: install-appservers.yml
# 
# This playbook install, configures and deploy the app server tier
#

- name:  Install/Deploy Application Tier
  hosts: appservers 
  #become: yes
  roles:

  # push any updates to the message of the day
  # parameters:
  #   system_manager - contact email listed in the motd
  #   specifying a parameter here will override anything specified in the defaults

  #- role: common/motd 
  #  system_manager: james.benedict@ssc-spc.gc.ca

  # check for any package updates and launch patching tool
  # note: this application will always upgrade to the LATEST version of all packages
  #- role: common/os-patching

  # since we don't have dns, we will need to manually create /etc/hosts
  # we will be using a variable to define the hosts
  #- role: common/push-host-map

  # call the role to set the firewall rules for appservers (tomcat)
  - role: appservers/firewall-appserver-tomcat

  # call the role to install and configure the appservers (tomcat)
  - role: appservers/setup-appserver-tomcat

  # call the role to deploy a new WAR file
  - {role: 'appservers/deploy-war-helloworld', tags: 'deploy-war'}